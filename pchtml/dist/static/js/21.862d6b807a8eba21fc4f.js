webpackJsonp([21],{OoJ5:function(t,a){},uxGR:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i={name:"bannerManagement",data:function(){var t=this;return{isShow:!1,editModal:!1,arcCate:"",arcCateList:[],arcId:"",arcList:[],isLoding:!1,table:{page:1,pagesize:10,total:50,columns:[{title:"排序",key:"location",align:"center"},{title:"图片",key:"image",align:"center",render:function(t,a){return t("img",{attrs:{src:a.row.image},style:{width:"35px",height:"35px"}})}},{title:"跳转模块",key:"link",align:"center"},{title:"操作",align:"center",width:150,render:function(a,e){return a("div",[a("i",{attrs:{class:"1"==e.row.status?"iconfont icon-yanjing":"iconfont icon-yanjing-bi"},on:{click:function(){t.changeBannerStatus(e.row)}}}),a("i",{attrs:{class:"iconfont icon-edit"},on:{click:function(){t.getgroups(),t.getArticle1(e.row)}}}),a("i",{attrs:{class:"iconfont icon-delete"},style:{color:"#ffc639"},on:{click:function(){t.deleteBanner(e.row)}}})])}}],data:[]},h5Img:"",formValidate:{type:"new",row:{},sort:"",status:"1"},ruleValidate:{sort:[{required:!0,message:"请输入排序号",pattern:/^[0-9]*$/,trigger:"blur"}],uploadimg:[{required:!0,validator:function(a,e,i){""==t.h5Img?i(new Error("请上传活动图片(大小不超过2M, 只支持png,jpg,jpeg,gif,bmp格式)")):i()},trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]}}},created:function(){this.getdata()},methods:{getdata:function(){var t=this;this.$http.post(this.PATH.GETPXBANNER,{page:this.table.page,size:this.table.pagesize}).then(function(a){200==a.status?0==a.data.errno?(t.table.data=a.data.list,t.table.total=a.data.total):t.$Modal.error({width:360,content:a.data.errmsg}):t.$Message.error("Fail!")})},changePage:function(t){this.table.page=t,this.getdata()},changeBannerStatus:function(t){var a=this;this.$http.post(this.PATH.CHANGEBANNERTATUS,{id:t.id,status:t.status}).then(function(t){"0"==t.data.errno&&a.$Modal.success({width:360,content:t.data.msg,onOk:function(){a.getdata()}})})},deleteBanner:function(t){var a=this;this.$http.post(this.PATH.DELETEBANNER,{id:t.id}).then(function(t){"0"==t.data.errno?a.$Modal.success({width:360,content:t.data.msg,onOk:function(){a.getdata()}}):a.$Message.error(t.data.errmsg)})},showEditModal:function(t,a){this.editErrorTip=!1,this.formValidate.type=t,this.$refs.formValidate.resetFields(),"new"==t?(this.getgroups(),this.formValidate.id="",this.isShow=!1,this.h5Img="",this.formValidate.row={id:"",sort:"",link:"",status:"1"},this.arcCate="",this.arcId=""):(this.isShow=!0,this.h5Img=a.image,this.formValidate.id=a.id,this.formValidate.sort=a.sort,this.formValidate.link=a.link,this.formValidate.status=a.status,this.arcCate=a.group_id,this.arcId=a.article_id),this.editModal=!0},getgroups:function(){var t=this;this.$http.get(this.PATH.GROUPS).then(function(a){0==a.data.errno?t.arcCateList=a.data.data:t.$Modal.error({width:360,content:a.data.errmsg})})},getArticle:function(t){var a=this;this.arcList=[],this.arcId="",this.arcCate=t,this.$http.post(this.PATH.PCARTICLETITLE,{group_id:t}).then(function(t){200==t.status&&(a.arcList=t.data.data)})},getArticle1:function(t){var a=this;this.editModal=!0,this.isLoding=!0,this.formValidate.id="",this.isShow=!1,this.h5Img="",this.formValidate.row={id:"",sort:"",link:"",status:"1"},this.arcCate="",this.arcId="",this.$http.post(this.PATH.PCARTICLETITLE,{group_id:t.group_id}).then(function(e){200==e.status&&(a.arcList=e.data.data,a.isShow=!0,a.h5Img=t.image,a.formValidate.id=t.id,a.formValidate.sort=t.sort,a.formValidate.link=t.link,a.formValidate.status=t.status,a.arcCate=t.group_id,a.arcId=t.article_id,a.isLoding=!1)})},searchArc:function(t){this.arcId=t},submitForm:function(t){var a=this;this.$refs[t].validate(function(t){if(t){var e=a.formValidate.type,i="",s=new Object;"new"==e?(i=a.PATH.CREATEBANNER,s={sort:a.formValidate.sort,link:a.formValidate.link,status:a.formValidate.status,image:a.h5Img,group_id:a.arcCate,article_id:a.arcId}):(i=a.PATH.CHANGEBANNER,s={id:a.formValidate.id,sort:a.formValidate.sort,link:a.formValidate.link,status:a.formValidate.status,image:a.h5Img,group_id:a.arcCate,article_id:a.arcId}),a.$http.post(i,s).then(function(t){a.formValidate.type,"0"==t.data.errno?a.$Modal.success({title:"提示",content:"success"==t.data.msg?"设置成功":t.data.msg,onOk:function(){a.editModal=!1}}):a.$Modal.success({title:"提示",content:t.data.errmsg,onOk:function(){a.editModal=!1}}),a.table.page=1,a.getdata()})}else a.$Message.error(success.data.errmsg)})},onUpload:function(t){var a=t.target.files||t.dataTransfer.files;if(a.length){t.target.files[0].type;var e=new FileReader;e.readAsDataURL(a[0]);var i=this;e.onload=function(t){var a=this;(new FormData).append("data",this.result);i.$http.post("/api/v1_0/uploadimage",{type:"jpg",data:this.result}).then(function(t){"0"==t.data.status?(i.isShow=!0,i.h5Img=t.data.url,i.$refs.formValidate.validateField("uploadimg")):i.$Modal.error({title:"提示",content:t.data.msg})},function(t){a.$Modal.error({title:"提示",content:success.data.msg})})}}}}},s={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"bannerManagement"}},[e("div",{staticClass:"h1"},[t._v("banner管理")]),t._v(" "),e("div",{staticClass:"header"},[e("Button",{staticClass:"newbtn zhijian-new-btn",attrs:{type:"primary"},on:{click:function(a){t.showEditModal("new")}}},[t._v("新增")])],1),t._v(" "),e("Table",{staticClass:"zhijian-table account-table",attrs:{stripe:"",columns:t.table.columns,data:t.table.data}}),t._v(" "),e("div",{staticClass:"zhijian-pagination"},[e("Page",{attrs:{total:t.table.total,current:t.table.page,"show-elevator":"",pageSize:t.table.pagesize},on:{"on-change":t.changePage}})],1),t._v(" "),e("Modal",{attrs:{"mask-closable":!1,width:"535","class-name":"ma-edit-modal"},model:{value:t.editModal,callback:function(a){t.editModal=a},expression:"editModal"}},[e("div",{staticClass:"edit-modal-body"},[e("Icon",{attrs:{type:"android-close"},on:{click:function(a){t.editModal=!1}}}),t._v(" "),"new"==t.formValidate.type?e("div",{staticClass:"title"},[t._v("新增banner")]):t._e(),t._v(" "),"edit"==t.formValidate.type?e("div",{staticClass:"title"},[t._v("编辑banner")]):t._e(),t._v(" "),e("Form",{ref:"formValidate",staticClass:"edit-form",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":100}},[e("FormItem",{attrs:{label:"排序",prop:"sort"}},[e("Input",{attrs:{placeholder:"请输入排序号"},model:{value:t.formValidate.sort,callback:function(a){t.$set(t.formValidate,"sort",a)},expression:"formValidate.sort"}})],1),t._v(" "),e("FormItem",{attrs:{label:"活动图片",prop:"uploadimg"}},[t.isShow?e("div",{staticClass:"h5ImgBox"},[e("img",{staticStyle:{width:"98px",height:"98px"},attrs:{src:t.h5Img}})]):t._e(),t._v(" "),e("div",[e("label",{staticClass:"button",attrs:{for:"inputFile"}},[e("span",{staticClass:"upload__select"},[t._v("点击上传图片")]),t._v(" "),e("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"inputFile",accept:"image/gif, image/jpeg, image/png, image/jpg"},on:{change:t.onUpload}})])])]),t._v(" "),e("FormItem",{attrs:{label:"跳转链接"}},[e("Input",{attrs:{placeholder:"请输入链接"},model:{value:t.formValidate.link,callback:function(a){t.$set(t.formValidate,"link",a)},expression:"formValidate.link"}})],1),t._v(" "),e("FormItem",{attrs:{label:"跳转文章类型",prop:"articlecategory"}},[e("Select",{on:{"on-change":t.getArticle},model:{value:t.arcCate,callback:function(a){t.arcCate=a},expression:"arcCate"}},[e("Option",{attrs:{value:""}},[t._v("不选择跳转文章类型")]),t._v(" "),t._l(t.arcCateList,function(a){return e("Option",{key:a.group_id,attrs:{value:a.group_id}},[t._v(t._s(a.group_name))])})],2)],1),t._v(" "),e("FormItem",{attrs:{label:"选择跳转文章",prop:"article"}},[e("Select",{on:{"on-change":t.searchArc},model:{value:t.arcId,callback:function(a){t.arcId=a},expression:"arcId"}},[e("Option",{attrs:{value:""}},[t._v("不选择跳转文章")]),t._v(" "),t._l(t.arcList,function(a){return e("Option",{key:a.article_id,attrs:{value:a.article_id}},[t._v(t._s(a.title))])})],2)],1),t._v(" "),e("FormItem",{attrs:{label:"状态",prop:"status"}},[e("RadioGroup",{model:{value:t.formValidate.status,callback:function(a){t.$set(t.formValidate,"status",a)},expression:"formValidate.status"}},[e("Radio",{attrs:{label:"1"}},[t._v("启用")]),t._v(" "),e("Radio",{attrs:{label:"0"}},[t._v("禁用")])],1)],1)],1)],1),t._v(" "),e("div",{staticClass:"zhijian-btn-box"},[e("div",{staticClass:"zhijian-btn-confirm",on:{click:function(a){t.submitForm("formValidate")}}},[t._v("确定")])]),t._v(" "),e("Col",{directives:[{name:"show",rawName:"v-show",value:t.isLoding,expression:"isLoding"}],staticClass:"demo-spin-col",attrs:{span:"8"}},[e("Spin",{attrs:{size:"large"}})],1)],1)],1)},staticRenderFns:[]};var r=e("VU/8")(i,s,!1,function(t){e("OoJ5")},null,null);a.default=r.exports}});