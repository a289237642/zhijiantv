webpackJsonp([28],{HS9P:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i={name:"tipoffList",data:function(){var t=this;return{hideIndex:[],arcCate:"",arcCateList:[],arcId:"",arcList:[],table:{page:1,pagesize:10,total:50,editTopId:"",columns:[{title:"排序",key:"sort_num",align:"center"},{title:"内容",key:"content",align:"center"},{title:"创建时间",key:"create_time",align:"center",sortable:!0},{title:"跳转文章",key:"jump_article_title",align:"center",sortable:!0},{title:"操作",align:"center",render:function(a,e){t.table.className;return a("div",[a("i",{attrs:{class:0==e.row.is_show?"iconfont icon-yanjing-bi":"iconfont icon-yanjing"},on:{click:function(){t.$http.post(t.PATH.UPLOADTOP,{top_id:e.row.top_id,is_show:e.row.is_show}).then(function(a){200==a.status&&t.getData()})}}}),a("i",{attrs:{class:"iconfont icon-edit"},on:{click:function(){t.formValidate.row=e.row,t.formValidate.type="edit",t.getgroups(),t.getArticle1(e.row)}}}),a("i",{attrs:{class:"iconfont icon-delete"},style:{color:"#ffc639"},on:{click:function(){t.$Modal.warning({content:"确定删除该热榜吗?",onOk:function(){t.$http.post(t.PATH.DELTOP,{top_id:e.row.top_id}).then(function(a){200==a.status&&(t.$Modal.success({width:360,content:a.data.errmsg}),t.getData())})}})}}})])}}],data:[]},editModal:!1,formValidate:{type:"new",row:{},content:""},ruleValidate:{content:[{required:!0,message:"请输入热榜内容",trigger:"blur"}]}}},created:function(){this.getData()},methods:{getData:function(){var t=this;this.$http.post(this.PATH.PCTOPS,{page:this.table.page,pagesize:this.table.pagesize}).then(function(a){200==a.status?0==a.data.errno?(t.table.data=a.data.data,t.table.total=a.data.count):t.$Modal.error({width:360,content:a.data.errmsg}):t.$Message.error("Fail!")})},showEditModal:function(t,a){this.getgroups(),this.formValidate.type=t,"new"==t?(this.$refs.formValidate.resetFields(),this.arcCate="",this.arcId="",this.arcList=[],this.arcCateList=[]):(this.table.editTopId=a.top_id,this.formValidate.content=a.content,this.formValidate.sort=a.sort_num,this.arcCate=a.jump_article_group_id,this.arcId=a.jump_article_id),this.editModal=!0},getArticle:function(t){var a=this;this.arcCate=t,""!=this.arcCate&&this.$http.post(this.PATH.ARTICLEGROUP,{group_id:this.arcCate,pagesize:100}).then(function(t){200==t.status&&(a.arcList=t.data.data)})},getArticle1:function(t){var a=this;this.arcCate=t.jump_article_group_id,this.$http.post(this.PATH.PCARTICLETITLE,{group_id:this.arcCate}).then(function(e){200==e.status&&(a.arcList=e.data.data,a.editModal=!0,a.table.editTopId=t.top_id,a.formValidate.content=t.content,a.formValidate.sort=t.sort_num,a.arcCate=t.jump_article_group_id,a.arcId=t.jump_article_id)})},searchArc:function(t){this.arcId=t.value,this.formValidate.content=t.label},rowClassName:function(t,a){this.table.className;return 0==t.is_show?"hide-table-row":""},submitForm:function(t){var a=this,e=this.formValidate.content,i=this.table.editTopId;this.$refs[t].validate(function(t){if(t){var o=a.formValidate.type,r=a.PATH.ADDTOP,n=new Object;n="new"==o?{content:e,sort_num:a.formValidate.sort,article_id:a.arcId,group_id:a.arcCate}:{content:e,top_id:i,sort_num:parseInt(a.formValidate.sort),article_id:a.arcId,group_id:a.arcCate},a.$http.post(r,n).then(function(t){a.formValidate.type,a.$Modal.success({title:"提示",content:t.data.errmsg,onOk:function(){a.editModal=!1}}),a.getData()})}else a.$Message.error("Fail!")})},changePage:function(t){this.table.page=t,this.getData()},getgroups:function(){var t=this;this.$http.get(this.PATH.GROUPS).then(function(a){0==a.data.errno?t.arcCateList=a.data.data:t.$Modal.error({width:360,content:a.data.errmsg})})}}},o={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"tipoffList"}},[e("div",{staticClass:"h1"},[t._v("24小时热榜")]),t._v(" "),e("div",{staticClass:"header"},[e("Button",{staticClass:"newbtn zhijian-new-btn",attrs:{type:"primary"},on:{click:function(a){t.showEditModal("new")}}},[t._v("新增")])],1),t._v(" "),e("Table",{staticClass:"zhijian-table account-table",attrs:{border:"","row-class-name":t.rowClassName,columns:t.table.columns,data:t.table.data}}),t._v(" "),e("div",{staticClass:"zhijian-pagination"},[e("Page",{attrs:{total:t.table.total,current:t.table.page,"show-elevator":"",pageSize:t.table.pagesize},on:{"on-change":t.changePage}})],1),t._v(" "),e("Modal",{attrs:{"mask-closable":!1,width:"535","class-name":"ma-edit-modal"},model:{value:t.editModal,callback:function(a){t.editModal=a},expression:"editModal"}},[e("div",{staticClass:"edit-modal-body"},[e("Icon",{attrs:{type:"android-close"},on:{click:function(a){t.editModal=!1}}}),t._v(" "),"new"==t.formValidate.type?e("div",{staticClass:"title"},[t._v("24小时热榜新增")]):t._e(),t._v(" "),"edit"==t.formValidate.type?e("div",{staticClass:"title"},[t._v("24小时热榜编辑")]):t._e(),t._v(" "),e("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":100}},[e("FormItem",{attrs:{label:"请输入内容",prop:"content"}},[e("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"Enter something..."},model:{value:t.formValidate.content,callback:function(a){t.$set(t.formValidate,"content",a)},expression:"formValidate.content"}})],1),t._v(" "),e("FormItem",{attrs:{label:"排序",prop:"sort"}},[e("Input",{attrs:{placeholder:"请输入排序号"},model:{value:t.formValidate.sort,callback:function(a){t.$set(t.formValidate,"sort",a)},expression:"formValidate.sort"}})],1),t._v(" "),e("FormItem",{attrs:{label:"跳转文章类型",prop:"articlecategory"}},[e("Select",{on:{"on-change":t.getArticle},model:{value:t.arcCate,callback:function(a){t.arcCate=a},expression:"arcCate"}},[e("Option",{attrs:{value:""}},[t._v("请选择")]),t._v(" "),t._l(t.arcCateList,function(a){return e("Option",{key:a.group_id,attrs:{value:a.group_id}},[t._v(t._s(a.group_name))])})],2)],1),t._v(" "),e("FormItem",{attrs:{label:"选择跳转文章",prop:"article",placeholder:"请先选择跳转文章类型"}},[e("Select",{attrs:{"value-key":"article","label-in-value":!0},on:{"on-change":t.searchArc},model:{value:t.arcId,callback:function(a){t.arcId=a},expression:"arcId"}},t._l(t.arcList,function(a){return e("Option",{key:a.article_id,attrs:{value:a.article_id}},[t._v(t._s(a.title))])}))],1)],1)],1),t._v(" "),e("div",{staticClass:"zhijian-btn-box"},[e("div",{staticClass:"zhijian-btn-confirm",on:{click:function(a){t.submitForm("formValidate")}}},[t._v("确定")])])])],1)},staticRenderFns:[]};var r=e("VU/8")(i,o,!1,function(t){e("kNk4")},null,null);a.default=r.exports},kNk4:function(t,a){}});