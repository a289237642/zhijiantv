webpackJsonp([10],{CCm4:function(e,t){},slBM:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={name:"channelList",data:function(){var e=this;return{isShow:!1,editModal:!1,spreadTypeList:[],is_search:!1,searchValue:"",table:{page:1,pagesize:10,total:50,columns:[{title:"序号",key:"location",align:"center",width:150},{title:"渠道名称",key:"spread_name",align:"center"},{title:"推广形式",align:"center",width:150,render:function(e,t){return e("div",1===t.row.spread_type_id?"海报":2===t.row.spread_type_id?"直跳":3===t.row.spread_type_id?"公众号":"")}},{title:"链接",key:"spread_url",align:"center"},{title:"操作",align:"center",render:function(t,a){return t("div",[t("i",{attrs:{class:"iconfont icon-edit"},on:{click:function(){e.showEditModal("edit",a.row)}}}),t("i",{attrs:{class:"iconfont icon-delete"},style:{color:"#ffc639"},on:{click:function(){e.$Modal.confirm({content:"是否删除该渠道？",onOk:function(t){e.deleteSperad(a.row)}})}}})])}}],data:[]},formValidate:{type:"new",spread_name:"",spread_type_name:""},ruleValidate:{spread_name:[{required:!0,message:"请输入渠道名称",trigger:"blur"}],spread_type_id:[{required:!0,message:"请选择推广形式",trigger:"blur",type:"number"}]}}},created:function(){this.getdata(this.table.page,this.table.pagesize),this.getspreadtype()},methods:{getdata:function(e,t){var a=this;this.$http.post(this.PATH.SPREADNAMELS,{page:e,pagesize:t}).then(function(e){200==e.status?0==e.data.errno?(a.table.data=e.data.data,a.table.total=e.data.count):a.$Modal.error({width:360,content:e.data.errmsg}):a.$Message.error("Fail!")})},getspreadtype:function(){var e=this;this.$http.get(this.PATH.SPREADTYPE).then(function(t){200==t.status&&(0==t.data.errno?e.spreadTypeList=t.data.data:e.$Modal.error({width:360,content:t.data.errmsg}))})},changePage:function(e){this.table.page=e,this.is_search?this.getSearch():this.getdata(e,this.table.pagesize)},deleteSperad:function(e){var t=this;this.$http.post(this.PATH.SPREADNAMEDEL,{spread_id:e.spread_id}).then(function(e){0==e.data.errno?t.getdata(t.table.page,t.table.pagesize):t.$Message.error(e.data.errmsg)})},showEditModal:function(e,t){this.formValidate.type=e,this.$refs.formValidate.resetFields(),"new"==e?(this.formValidate.spread_name="",this.formValidate.spread_type_id=""):(this.formValidate.spread_name=t.spread_name,this.formValidate.spread_type_id=t.spread_type_id,this.formValidate.spread_id=t.spread_id),this.editModal=!0},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var a=t.formValidate.type,s=new Object;s="new"==a?{spread_name:t.formValidate.spread_name,spread_type_id:t.formValidate.spread_type_id}:{spread_name:t.formValidate.spread_name,spread_type_id:t.formValidate.spread_type_id,spread_id:t.formValidate.spread_id},t.$http.post(t.PATH.SPREADNAMEUPDATE,s).then(function(e){"0"==e.data.errno?t.generateSperadUrl(e.data.spread_id,s.spread_type_id):t.$Modal.success({title:"提示",content:e.data.errmsg,onOk:function(){t.editModal=!1}})})}else t.$Message.error(success.data.errmsg)})},generateSperadUrl:function(e,t){var a=this,s=t,i=e,r=new Object;r=1==s?{spread_id:e,page:"pages/changehome/main",scene:"sid="+i+"&sTyId="+s}:{spread_id:e,path:"pages/changehome/main?spread_id="+i+"&spread_type_id="+s},this.$http.post(this.PATH.GENERATESPERATEURL,r).then(function(e){200==e.status&&("0"==e.data.errno?(a.$Modal.success({title:"提示",content:"OK"==e.data.errmsg?"设置成功":e.data.errmsg,onOk:function(){a.editModal=!1}}),a.table.page=1,a.getdata(a.table.page,a.table.pagesize)):a.$Modal.success({title:"提示",content:e.data.errmsg,onOk:function(){}}))})},getSearch:function(){var e=this;this.is_search=!0,this.$http.post(this.PATH.SPREADNAMESEARCH,{page:this.table.page,pagesize:this.table.pagesize,words:this.searchValue}).then(function(t){200==t.status?0==t.data.errno?(e.table.data=t.data.data,e.table.total=t.data.count):e.$Modal.error({width:360,content:t.data.errmsg}):e.$Message.error("Fail!")})}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"channelList"}},[a("div",{staticClass:"h1"},[e._v("渠道列表")]),e._v(" "),a("div",{staticClass:"header"},[a("Input",{staticClass:"search",attrs:{search:"","enter-button":"搜索",placeholder:"快速搜索"},on:{"on-search":e.getSearch,"on-blur":function(t){e.table.page=1},"on-enter":function(t){e.table.page=1}},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}}),e._v(" "),a("Button",{staticClass:"newbtn zhijian-new-btn",attrs:{type:"primary"},on:{click:function(t){e.showEditModal("new")}}},[e._v("新增")])],1),e._v(" "),a("Table",{staticClass:"zhijian-table account-table",attrs:{stripe:"",columns:e.table.columns,data:e.table.data}}),e._v(" "),a("div",{staticClass:"zhijian-pagination"},[a("Page",{attrs:{total:e.table.total,current:e.table.page,"show-elevator":"",pageSize:e.table.pagesize},on:{"on-change":e.changePage}})],1),e._v(" "),a("Modal",{attrs:{"mask-closable":!1,width:"535","class-name":"ma-edit-modal"},model:{value:e.editModal,callback:function(t){e.editModal=t},expression:"editModal"}},[a("div",{staticClass:"edit-modal-body"},[a("Icon",{attrs:{type:"android-close"},on:{click:function(t){e.editModal=!1}}}),e._v(" "),"new"==e.formValidate.type?a("div",{staticClass:"title"},[e._v("新增渠道")]):e._e(),e._v(" "),"edit"==e.formValidate.type?a("div",{staticClass:"title"},[e._v("编辑渠道")]):e._e(),e._v(" "),a("Form",{ref:"formValidate",staticClass:"edit-form",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":100}},[a("FormItem",{attrs:{label:"渠道名称",prop:"spread_name"}},[a("Input",{attrs:{placeholder:"请输入渠道名称"},model:{value:e.formValidate.spread_name,callback:function(t){e.$set(e.formValidate,"spread_name",t)},expression:"formValidate.spread_name"}})],1),e._v(" "),a("FormItem",{attrs:{label:"推广形式",prop:"spread_type_id"}},[a("Select",{model:{value:e.formValidate.spread_type_id,callback:function(t){e.$set(e.formValidate,"spread_type_id",t)},expression:"formValidate.spread_type_id"}},e._l(e.spreadTypeList,function(t){return a("Option",{key:t.spread_type_id,attrs:{value:t.spread_type_id}},[e._v(e._s(t.spread_type_name))])}))],1)],1)],1),e._v(" "),a("div",{staticClass:"zhijian-btn-box"},[a("div",{staticClass:"zhijian-btn-confirm",on:{click:function(t){e.submitForm("formValidate")}}},[e._v("确定")])])])],1)},staticRenderFns:[]};var r=a("VU/8")(s,i,!1,function(e){a("CCm4")},null,null);t.default=r.exports}});