webpackJsonp([31],{"7eTR":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i={name:"advList",data:function(){var t=this;return{isShow:!1,editModal:!1,arcCate:"",arcCateList:[],arcId:"",arcList:[],isLoding:!1,table:{page:1,pagesize:10,total:50,columns:[{title:"排序",key:"sort_num",align:"center"},{title:"图片",key:"img_url",align:"center",render:function(t,a){return t("img",{attrs:{src:a.row.img_url},style:{width:"70px",height:"35px"}})}},{title:"钢镚数",key:"coin",align:"center"},{title:"文案信息",key:"words",align:"center"},{title:"appId",key:"app_id",align:"center"},{title:"小程序名称",key:"name",align:"center"},{title:"操作",align:"center",width:150,render:function(a,e){return a("div",[a("i",{attrs:{class:"1"==e.row.is_show?"iconfont icon-yanjing":"iconfont icon-yanjing-bi"},on:{click:function(){t.changeBannerStatus(e.row)}}}),a("i",{attrs:{class:"iconfont icon-edit"},on:{click:function(){t.showEditModal("edit",e.row)}}}),a("i",{attrs:{class:"iconfont icon-delete"},style:{color:"#ffc639"},on:{click:function(){t.deleteBanner(e.row)}}})])}}],data:[]},h5Img:"",formValidate:{type:"new",row:{},sort_num:"",name:"",is_show:"1",coin:"",words:"",path:""},ruleValidate:{coin:[{required:!0,message:"请输入奖励钢镚数",pattern:/^[0-9]*$/,trigger:"blur"}],sort_num:[{required:!0,message:"请输入排序号",pattern:/^[0-9]*$/,trigger:"blur"}],uploadimg:[{required:!0,validator:function(a,e,i){""==t.h5Img?i(new Error("请上传活动图片(大小不超过2M, 只支持png,jpg,jpeg,gif,bmp格式)")):i()},trigger:"blur"}],words:[{required:!0,message:"请输入文案信息",trigger:"blur"}],name:[{required:!0,message:"请输入小程序名称",trigger:"blur"}]}}},created:function(){this.getdata()},methods:{getdata:function(){var t=this;this.$http.post(this.PATH.MINIPROGRAMLS,{page:this.table.page,pagesize:this.table.pagesize}).then(function(a){200==a.status?0==a.data.errno?(t.table.data=a.data.data,t.table.data.coin=5,t.table.total=a.data.count):t.$Modal.error({width:360,content:a.data.errmsg}):t.$Message.error("Fail!")})},changePage:function(t){this.table.page=t,this.getdata()},changeBannerStatus:function(t){var a=this;this.$http.post(this.PATH.MINICHANGESTATUS,{mini_program_id:t.mini_program_id}).then(function(t){"0"==t.data.errno&&a.$Modal.success({width:360,content:t.data.errmsg,onOk:function(){a.getdata()}})})},deleteBanner:function(t){var a=this,e=[];e.push(t.mini_program_id),this.$http.post(this.PATH.DELMINIPROGRAM,{mini_program_id_list:e}).then(function(t){0==t.data.errno?a.$Modal.success({width:360,content:t.data.errmsg,onOk:function(){a.getdata()}}):a.$Message.error(t.data.errmsg)})},showEditModal:function(t,a){this.formValidate.type=t,this.$refs.formValidate.resetFields(),"new"==t?(this.formValidate.mini_program_id="",this.isShow=!1,this.h5Img="",this.formValidate.row={mini_program_id:"",sort_num:"",name:"",is_show:"1",coin:"",app_id:"",words:"",path:""},this.arcCate="",this.arcId=""):(this.isShow=!0,this.h5Img=a.img_url,this.formValidate.mini_program_id=a.mini_program_id,this.formValidate.sort_num=a.sort_num,this.formValidate.name=a.name,this.formValidate.is_show=a.is_show+"",this.formValidate.coin=a.coin,this.formValidate.app_id=a.app_id,this.formValidate.words=a.words,this.formValidate.path=a.path),this.editModal=!0},submitForm:function(t){var a=this;this.$refs[t].validate(function(t){if(t){var e=a.formValidate.type,i=new Object;i="new"==e?{sort_num:a.formValidate.sort_num,name:a.formValidate.name,is_show:a.formValidate.is_show,img_url:a.h5Img,coin:a.formValidate.coin,app_id:a.formValidate.app_id,words:a.formValidate.words,path:a.formValidate.path}:{mini_program_id:a.formValidate.mini_program_id,sort_num:a.formValidate.sort_num,name:a.formValidate.name,is_show:a.formValidate.is_show,coin:a.formValidate.coin,app_id:a.formValidate.app_id,words:a.formValidate.words,path:a.formValidate.path,img_url:a.h5Img},a.$http.post(a.PATH.UPDATEMINIPROGRAM,i).then(function(t){a.formValidate.type,"0"==t.data.errno?a.$Modal.success({title:"提示",content:"OK"==t.data.errmsg?"设置成功":t.data.errmsg,onOk:function(){a.editModal=!1}}):a.$Modal.success({title:"提示",content:t.data.errmsg,onOk:function(){a.editModal=!1}}),a.table.page=1,a.getdata()})}else a.$Message.error(success.data.errmsg)})},onUpload:function(t){var a=t.target.files||t.dataTransfer.files;if(a.length){t.target.files[0].type;var e=new FileReader;e.readAsDataURL(a[0]);var i=this;e.onload=function(t){var a=this;(new FormData).append("data",this.result);i.$http.post("/api/v1_0/uploadimage",{type:"jpg",data:this.result}).then(function(t){"0"==t.data.status?(i.isShow=!0,i.h5Img=t.data.url,i.$refs.formValidate.validateField("uploadimg")):i.$Modal.error({title:"提示",content:t.data.msg})},function(t){a.$Modal.error({title:"提示",content:success.data.msg})})}}}}},o={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"advList"}},[e("div",{staticClass:"h1"},[t._v("换量列表")]),t._v(" "),e("div",{staticClass:"header"},[e("Button",{staticClass:"newbtn zhijian-new-btn",attrs:{disabled:t.table.data.length>=10,type:"primary"},on:{click:function(a){t.showEditModal("new")}}},[t._v("新增")])],1),t._v(" "),e("Table",{staticClass:"zhijian-table account-table",attrs:{stripe:"",columns:t.table.columns,data:t.table.data}}),t._v(" "),e("div",{staticClass:"zhijian-pagination"},[e("Page",{attrs:{total:t.table.total,current:t.table.page,"show-elevator":"",pageSize:t.table.pagesize},on:{"on-change":t.changePage}})],1),t._v(" "),e("Modal",{attrs:{"mask-closable":!1,width:"535","class-name":"ma-edit-modal"},model:{value:t.editModal,callback:function(a){t.editModal=a},expression:"editModal"}},[e("div",{staticClass:"edit-modal-body"},[e("Icon",{attrs:{type:"android-close"},on:{click:function(a){t.editModal=!1}}}),t._v(" "),"new"==t.formValidate.type?e("div",{staticClass:"title"},[t._v("新增换量")]):t._e(),t._v(" "),"edit"==t.formValidate.type?e("div",{staticClass:"title"},[t._v("编辑换量")]):t._e(),t._v(" "),e("Form",{ref:"formValidate",staticClass:"edit-form",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":100}},[e("FormItem",{attrs:{label:"排序",prop:"sort_num"}},[e("Input",{attrs:{placeholder:"请输入排序号"},model:{value:t.formValidate.sort_num,callback:function(a){t.$set(t.formValidate,"sort_num",a)},expression:"formValidate.sort_num"}})],1),t._v(" "),e("FormItem",{attrs:{label:"广告图片",prop:"uploadimg"}},[t.isShow?e("div",{staticClass:"h5ImgBox"},[e("img",{staticStyle:{width:"198px",height:"98px"},attrs:{src:t.h5Img}})]):t._e(),t._v(" "),e("div",[e("label",{staticClass:"button",attrs:{for:"inputFile"}},[e("span",{staticClass:"upload__select"},[t._v("点击上传图片")]),t._v(" "),e("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"inputFile",accept:"image/gif, image/jpeg, image/png, image/jpg"},on:{change:t.onUpload}})])])]),t._v(" "),e("FormItem",{attrs:{label:"奖励钢镚数",prop:"coin"}},[e("Input",{attrs:{placeholder:"请输入奖励钢镚数"},model:{value:t.formValidate.coin,callback:function(a){t.$set(t.formValidate,"coin",a)},expression:"formValidate.coin"}})],1),t._v(" "),e("FormItem",{attrs:{label:"appId"}},["edit"==t.formValidate.type?e("Input",{attrs:{disabled:""},model:{value:t.formValidate.app_id,callback:function(a){t.$set(t.formValidate,"app_id",a)},expression:"formValidate.app_id"}}):t._e(),t._v(" "),"new"==t.formValidate.type?e("Input",{model:{value:t.formValidate.app_id,callback:function(a){t.$set(t.formValidate,"app_id",a)},expression:"formValidate.app_id"}}):t._e()],1),t._v(" "),e("FormItem",{attrs:{label:"文案信息",prop:"words"}},[e("Input",{model:{value:t.formValidate.words,callback:function(a){t.$set(t.formValidate,"words",a)},expression:"formValidate.words"}})],1),t._v(" "),e("FormItem",{attrs:{label:"小程序名称",prop:"name"}},[e("Input",{model:{value:t.formValidate.name,callback:function(a){t.$set(t.formValidate,"name",a)},expression:"formValidate.name"}})],1),t._v(" "),e("FormItem",{attrs:{label:"换量路径",prop:"path"}},[e("Input",{model:{value:t.formValidate.path,callback:function(a){t.$set(t.formValidate,"path",a)},expression:"formValidate.path"}})],1),t._v(" "),e("FormItem",{attrs:{label:"状态",prop:"is_show"}},[e("RadioGroup",{model:{value:t.formValidate.is_show,callback:function(a){t.$set(t.formValidate,"is_show",a)},expression:"formValidate.is_show"}},[e("Radio",{attrs:{label:"1"}},[t._v("启用")]),t._v(" "),e("Radio",{attrs:{label:"0"}},[t._v("禁用")])],1)],1)],1)],1),t._v(" "),e("div",{staticClass:"zhijian-btn-box"},[e("div",{staticClass:"zhijian-btn-confirm",on:{click:function(a){t.submitForm("formValidate")}}},[t._v("确定")])]),t._v(" "),e("Col",{directives:[{name:"show",rawName:"v-show",value:t.isLoding,expression:"isLoding"}],staticClass:"demo-spin-col",attrs:{span:"8"}},[e("Spin",{attrs:{size:"large"}})],1)],1)],1)},staticRenderFns:[]};var r=e("VU/8")(i,o,!1,function(t){e("iJT2")},null,null);a.default=r.exports},iJT2:function(t,a){}});