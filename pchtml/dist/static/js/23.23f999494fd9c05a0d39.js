webpackJsonp([23],{"8upG":function(t,a){},nR3t:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i={name:"ActivityList",data:function(){var t=this;return{table:{page:1,pagesize:10,total:50,columns:[{title:"活动id",key:"activityid",width:100,align:"center"},{title:"排序",key:"sort",align:"center"},{title:"活动标题",key:"title",align:"center"},{title:"活动图片",key:"main_img",align:"center",render:function(t,a){return t("img",{attrs:{src:a.row.main_img},style:{width:"35px",height:"35px"}})}},{title:"跳转链接",key:"link",align:"center"},{title:"标签",key:"tag",align:"center"},{title:"操作",align:"center",render:function(a,e){return a("div",[a("i",{attrs:{class:"iconfont icon-edit"},on:{click:function(){t.showEditModal("edit",e.row)}}}),a("i-switch",{attrs:{title:"0"==e.row.status?"已停用":"已启用"},props:{value:e.row.status,trueValue:"1",falseValue:"0"},on:{"on-change":function(a){t.changeStatus(e.row.id,e.row._index,a)}}})])}}],data:[]},isShow:!1,editModal:!1,h5Img:"",formValidate:{type:"new",row:{},title:"",sort:"",tag:"",main_img:"",link:"",status:"1"},ruleValidate:{sort:[{required:!0,message:"请输入排序号",pattern:/^[0-9]*$/,trigger:"blur"}],title:[{required:!0,message:"请输入标题",trigger:"blur"}],uploadimg:[{required:!0,validator:function(a,e,i){""==t.h5Img?i(new Error("请上传图片(大小不超过2M, 只支持png,jpg,jpeg,gif,bmp格式)")):i()},trigger:"blur"}],link:[{required:!0,message:"请输入链接",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]}}},created:function(){this.getData()},methods:{getData:function(){var t=this;this.$http.post(this.PATH.GETPCACTIVITY,{page:this.table.page,size:this.table.pagesize}).then(function(a){0==a.data.status?(t.table.data=a.data.list,t.table.total=a.data.total):t.$Modal.error({width:360,content:a.data.errmsg})})},changePage:function(t){this.table.page=t,this.getData()},changeStatus:function(t,a,e){var i=this;this.$http.post(this.PATH.CHANGESTATUS,{id:t,status:this.table.data[a].status}).then(function(t){"0"==t.data.status?i.table.data[a].status=e:(i.table.data[a].status="1"==e?"0":"1",i.$Modal.error({width:360,content:t.data.msg})),i.getData()})},showEditModal:function(t,a){this.editErrorTip=!1,this.formValidate.type=t,this.$refs.formValidate.resetFields(),"new"==t?(this.formValidate.id="",this.isShow=!1,this.formValidate.tag="",this.h5Img="",this.formValidate.row={id:"",title:"",sort:"",link:" ",status:"1",tag:""}):(this.isShow=!0,this.h5Img=a.main_img,this.formValidate.id=a.id,this.formValidate.title=a.title,this.formValidate.sort=a.sort,this.formValidate.link=a.link,this.formValidate.status=a.status,this.formValidate.tag=a.tag),this.editModal=!0},submitForm:function(t){var a=this;this.$refs[t].validate(function(t){if(t){var e=a.formValidate.type,i="",l=new Object;"new"==e?(i=a.PATH.CREATEACTIVITY,l={title:a.formValidate.title,sort:a.formValidate.sort,link:a.formValidate.link,status:a.formValidate.status,tag:a.formValidate.tag,main_img:a.h5Img}):(i=a.PATH.CHANGEACTIVITY,l={id:a.formValidate.id,title:a.formValidate.title,sort:a.formValidate.sort,link:a.formValidate.link,status:a.formValidate.status,tag:a.formValidate.tag,main_img:a.h5Img}),a.$http.post(i,l).then(function(t){a.formValidate.type,a.$Modal.success({title:"提示",content:t.data.msg,onOk:function(){a.editModal=!1}}),a.table.page=1,a.getData()})}else a.$Message.error("Fail!")})},onUpload:function(t){var a=t.target.files||t.dataTransfer.files;if(a.length){t.target.files[0].type;var e=new FileReader;e.readAsDataURL(a[0]);var i=this;e.onload=function(t){var a=this;(new FormData).append("data",this.result);i.$http.post("/api/v1_0/uploadimage",{type:"jpg",data:this.result}).then(function(t){"0"==t.data.status?(i.isShow=!0,i.h5Img=t.data.url,i.$refs.formValidate.validateField("uploadimg")):i.$Modal.error({title:"提示",content:t.data.msg})},function(t){a.$Modal.error({title:"提示",content:t.data.msg})})}}}}},l={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"ActivityList"}},[e("div",{staticClass:"h1"},[t._v("活动列表")]),t._v(" "),e("div",{staticClass:"header"},[e("Button",{staticClass:"newbtn zhijian-new-btn",attrs:{type:"primary"},on:{click:function(a){t.showEditModal("new")}}},[t._v("新增")])],1),t._v(" "),e("Table",{staticClass:"zhijian-table account-table",attrs:{stripe:"",columns:t.table.columns,data:t.table.data}}),t._v(" "),e("div",{staticClass:"zhijian-pagination"},[e("Page",{attrs:{total:t.table.total,current:t.table.page,"show-elevator":"",pageSize:t.table.pagesize},on:{"on-change":t.changePage}})],1),t._v(" "),e("Modal",{attrs:{"mask-closable":!1,width:"535","class-name":"ma-edit-modal"},model:{value:t.editModal,callback:function(a){t.editModal=a},expression:"editModal"}},[e("div",{staticClass:"edit-modal-body"},[e("Icon",{attrs:{type:"android-close"},on:{click:function(a){t.editModal=!1}}}),t._v(" "),"new"==t.formValidate.type?e("div",{staticClass:"title"},[t._v("新增活动")]):t._e(),t._v(" "),"edit"==t.formValidate.type?e("div",{staticClass:"title"},[t._v("编辑活动信息")]):t._e(),t._v(" "),e("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":80}},[e("FormItem",{attrs:{label:"排序",prop:"sort"}},[e("Input",{attrs:{placeholder:"请输入排序号"},model:{value:t.formValidate.sort,callback:function(a){t.$set(t.formValidate,"sort",a)},expression:"formValidate.sort"}})],1),t._v(" "),e("FormItem",{attrs:{label:"活动标题",prop:"title"}},[e("Input",{attrs:{placeholder:"请输入活动标题"},model:{value:t.formValidate.title,callback:function(a){t.$set(t.formValidate,"title",a)},expression:"formValidate.title"}})],1),t._v(" "),e("FormItem",{attrs:{label:"上传图片",prop:"uploadimg"}},[t.isShow?e("div",{staticClass:"h5ImgBox"},[e("img",{staticStyle:{width:"98px",height:"98px"},attrs:{src:t.h5Img}})]):t._e(),t._v(" "),e("div",[e("label",{staticClass:"button",attrs:{for:"inputFile"}},[e("span",{staticClass:"upload__select"},[t._v("点击上传图片")]),t._v(" "),e("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"inputFile",accept:"image/gif, image/jpeg, image/png, image/jpg"},on:{change:t.onUpload}})])])]),t._v(" "),e("FormItem",{attrs:{label:"跳转链接",prop:"link"}},[e("Input",{attrs:{placeholder:"请输入链接"},model:{value:t.formValidate.link,callback:function(a){t.$set(t.formValidate,"link",a)},expression:"formValidate.link"}})],1),t._v(" "),e("FormItem",{attrs:{label:"标签"}},[e("Input",{attrs:{placeholder:"请输入标签"},model:{value:t.formValidate.tag,callback:function(a){t.$set(t.formValidate,"tag",a)},expression:"formValidate.tag"}})],1),t._v(" "),e("FormItem",{attrs:{label:"状态",prop:"status"}},[e("RadioGroup",{model:{value:t.formValidate.status,callback:function(a){t.$set(t.formValidate,"status",a)},expression:"formValidate.status"}},[e("Radio",{attrs:{label:"1"}},[t._v("启用")]),t._v(" "),e("Radio",{attrs:{label:"0"}},[t._v("禁用")])],1)],1)],1)],1),t._v(" "),e("div",{staticClass:"zhijian-btn-box"},[e("div",{staticClass:"zhijian-btn-confirm",on:{click:function(a){t.submitForm("formValidate")}}},[t._v("确定")])])])],1)},staticRenderFns:[]};var s=e("VU/8")(i,l,!1,function(t){e("8upG")},null,null);a.default=s.exports}});