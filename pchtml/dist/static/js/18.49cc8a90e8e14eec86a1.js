webpackJsonp([18],{VnUV:function(t,a){},iIwn:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("PJh5"),o=e.n(i),n={name:"tipoffLibrary",data:function(){var t=this;return{is_search:"",words:"",startDate:"",endDate:"",arcSource:"",editPicModal:!1,uploadModal:!1,addLinkModal:!1,isDisable:!0,h5Img:"",articleid_img:"",checkedGroup:[],groups:[],articleSource:[],articleid:"",isShow:!1,isLoding:!1,isHide:!0,onlineid:0,detailModal:!1,art_detail:{},checkedArc:[],table:{page:1,pagesize:20,total:50,columns:[{type:"selection",title:"全选",width:60,align:"center"},{title:"内容",key:"content",width:500,render:function(a,e){return a("div",{style:{display:"flex",alignItems:"center",height:"120px"},on:{click:function(){t.detailModal=!0,t.onlineid=e.row.article_id,t.getDetail()}}},[a("div",{style:{width:"160px",height:"90px",overflow:"hidden",marginRight:"20px",position:"relative"}},[a("img",{attrs:{src:e.row.min_pic},style:{width:"160px"}})]),a("div",{style:{}},[a("p",{style:{fontSize:"18px",color:"#999",width:"300px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",webkitLineClamp:2,webkitBoxOrient:"vertical"}},e.row.title),a("p",{style:{fontSize:"18px",color:"#999",width:"300px"}},[a("span","转载："),a("span",{style:{color:"blue"}},e.row.author)])])])}},{title:"文章发布时间",key:"wechat_art_date",align:"center",render:function(a,e){return a("div",t.formatMoment(e.row.wechat_art_date,"MM月DD日"))}},{title:"操作",align:"center",render:function(a,e){return a("div",[a("i-button",{attrs:{title:""},style:{marginRight:"10px"},on:{click:function(){t.onUploadPic(e.row.min_pic,e.row.article_id)}}},"设置头图"),a("i-button",{attrs:{title:""},style:{marginRight:"10px"},on:{click:function(){t.uploadStatus(e.row.article_id)}}},"上线"),a("i-button",{on:{click:function(){t.$Modal.warning({content:"确定删除该爆料吗?",onOk:function(){t.deleteTipoff(e.row.article_id)}})}}},"删除")])}}],data:[]},formValidate:{main_img:""},ruleValidate:{uploadimg:[{required:!0,validator:function(a,e,i){""==t.h5Img?i(new Error("请上传文章头图(大小不超过2M, 只支持jpg,jpeg,gif,bmp格式)")):i()},trigger:"blur"}]},formValidate1:{link:""},ruleValidate1:{link:[{required:!0,message:"请输入要抓取的文章链接",trigger:"blur"}]}}},methods:{getData:function(){var t=this;this.$http.post(this.PATH.ARTICLES,{page:this.table.page,pagesize:this.table.pagesize,is_show:0}).then(function(a){0==a.data.errno?(t.table.data=a.data.data,t.table.total=a.data.count):t.$Modal.error({width:360,content:a.data.errmsg})})},changePage:function(t){this.table.page=t,this.is_search?this.searchTipoff():this.getData()},formatMoment:function(t,a){return a=a||"YYYY-MM-DD HH:mm:ss",o()(t).format(a)},getStart:function(t){this.startDate=t},getEnd:function(t){this.endDate=t},getCate:function(t){this.arcSource=t},searchTipoff:function(){var t=this;this.is_search=!0,this.$http.post(this.PATH.ARTICLESSearch,{page:this.table.page,words:this.words,web_name:this.arcSource,start_time:this.startDate,end_time:this.endDate,is_show:0}).then(function(a){0==a.data.errno?(t.table.data=a.data.data,t.table.total=a.data.count):t.$Modal.error({width:360,content:a.data.errmsg})})},showLinkModal:function(){this.addLinkModal=!0},submitLinkForm:function(t){var a=this;this.isHide=!1,this.isLoding=!0,this.$refs[t].validate(function(t){if(t){var e,i=new Object;e=a.PATH.WECHATURL,i={url:a.formValidate1.link},a.$http.post(e,i).then(function(t){200==t.status?(a.isHide=!0,a.isLoding=!1,a.$Modal.error({width:360,content:t.data.errmsg}),a.addLinkModal=!1,a.formValidate1.link="",a.getData()):a.$Modal.error({width:360,content:t.data.errmsg})})}else a.$Message.error("Fail!")})},deleteTipoff:function(t){var a=this,e=[];e.push(t),this.$http.post(this.PATH.DELARTICLE,{article_id_list:e}).then(function(t){0==t.data.errno?a.getData():a.$Modal.error({width:360,content:t.data.errmsg})})},delectArcs:function(){var t=this;this.$Modal.warning({content:"确定删除该爆料吗?",onOk:function(){t.$http.post(t.PATH.DELARTICLE,{article_id_list:t.checkedArc}).then(function(a){0==a.data.errno?(t.getData(),t.checkedArc=[]):t.$Modal.error({width:360,content:a.data.errmsg})})}})},onUploadPic:function(t,a){this.editPicModal=!0,this.h5Img=t,this.articleid_img=a,this.isShow=!0},submitForm:function(t){var a=this;this.$refs[t].validate(function(t){if(t){a.formValidate.type;var e,i=new Object;e=a.PATH.MINPIC,i={article_id:a.articleid_img,img:a.formValidate.main_img},a.$http.post(e,i).then(function(t){a.$Message.success(t.data.errmsg),a.editPicModal=!1,a.getData()})}else a.$Message.error("Fail!")})},onUpload:function(t){var a=t.target.files||t.dataTransfer.files;if(a.length){var e=t.target.files[0].type;if(""==e||["png","jpg","jpeg","gif","bmp"].indexOf(e.split("/")[1])<0||t.target.files[0].size>2097152)return this.h5Img="",void this.$refs.formValidate.validateField("qrcard");var i=new FileReader;i.readAsDataURL(a[0]);var o=this;i.onload=function(t){var a=this;(new FormData).append("bs4",this.result);var i=o.PATH.UPLOADIMAGE;o.$http.post(i,{type:e,data:this.result}).then(function(t){"0"==t.data.status?(o.isShow=!0,o.h5Img=t.data.url,o.formValidate.main_img=t.data.url,o.$refs.formValidate.validateField("uploadimg")):o.$Modal.error({title:"提示",content:t.data.errmsg})},function(t){a.$Modal.error({title:"提示",content:"上传失败，请重试"})})}}},getArticleSourse:function(){var t=this;this.$http.post(this.PATH.ARTICLESOURCE,{is_show:0}).then(function(a){0==a.data.errno?t.articleSource=a.data.data:t.$Modal.error({width:360,content:a.data.errmsg})})},getGroups:function(){var t=this;this.$http.get(this.PATH.GROUPS).then(function(a){0==a.data.errno?t.groups=a.data.data:t.$Modal.error({width:360,content:a.data.errmsg})})},uploadStatus:function(t){this.uploadModal=!0,this.checkedArc.push(t),this.getGroups()},uploadStatus1:function(){this.uploadModal=!0,this.getGroups()},onlineArc:function(t){var a=this;this.checkedArc=[],t.forEach(function(t){a.checkedArc.push(t.article_id)})},onArc:function(t){var a=this;this.checkedArc=[],t.forEach(function(t){a.checkedArc.push(t.article_id)})},checkMoreGroupChange:function(t){this.checkedGroup=t},editcategory:function(){var t=this,a=this.checkedGroup;this.$http.post(this.PATH.ONLINE,{article_id_list:this.checkedArc,group_id_list:a}).then(function(a){0==a.data.errno?(t.$Modal.error({width:360,content:a.data.errmsg}),t.checkedArc=[],t.getData()):t.$Modal.error({width:360,content:a.data.errmsg}),t.checkedGroup=[],t.uploadModal=!1})},getDetail:function(){var t=this;this.art_detail={},this.$http.post(this.PATH.ARTICLEDETAILS,{article_id:this.onlineid}).then(function(a){0==a.data.errno?t.art_detail=a.data.data:t.$Modal.error({width:360,content:a.data.errmsg})})}},created:function(){this.getData(),this.getGroups(),this.getArticleSourse()}},r={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"tipoffLibrary"}},[e("div",{staticClass:"h1"},[t._v("爆料库\n    "),e("div",{staticClass:"search"},[e("Input",{attrs:{search:"","enter-button":"搜索",placeholder:"请输入搜索关键字"},on:{"on-search":t.searchTipoff},model:{value:t.words,callback:function(a){t.words=a},expression:"words"}})],1)]),t._v(" "),e("div",{staticClass:"header"},[e("DatePicker",{staticStyle:{width:"120px"},attrs:{type:"date",placeholder:"开始日期"},on:{"on-change":t.getStart},model:{value:t.startDate,callback:function(a){t.startDate=a},expression:"startDate"}}),t._v("至\n    "),e("DatePicker",{staticStyle:{width:"120px"},attrs:{type:"date",placeholder:"结束日期"},on:{"on-change":t.getEnd},model:{value:t.endDate,callback:function(a){t.endDate=a},expression:"endDate"}}),t._v(" "),e("Select",{staticStyle:{width:"100px","margin-right":"270px"},attrs:{placeholder:"全部来源"},on:{"on-change":t.getCate},model:{value:t.arcSource,callback:function(a){t.arcSource=a},expression:"arcSource"}},[e("Option",{attrs:{value:""}},[t._v("全部来源")]),t._v(" "),t._l(t.articleSource,function(a){return e("Option",{key:a,attrs:{value:a}},[t._v(t._s(a))])})],2),t._v(" "),e("Button",{staticClass:"newbtn zhijian-new-btn",attrs:{type:"primary"},on:{click:function(a){t.showLinkModal()}}},[t._v("新增")]),t._v(" "),e("Button",{staticClass:"newbtn1 zhijian-new-btn",attrs:{type:"primary"},on:{click:t.uploadStatus1}},[t._v("批量上线")]),t._v(" "),e("Button",{staticClass:"newbtn2 zhijian-new-btn",attrs:{type:"primary"},on:{click:t.delectArcs}},[t._v("批量删除")])],1),t._v(" "),e("Table",{ref:"selection",staticClass:"zhijian-table account-table",attrs:{stripe:"",columns:t.table.columns,data:t.table.data},on:{"on-selection-change":t.onArc,"on-select-all":t.onlineArc}}),t._v(" "),e("div",{staticClass:"zhijian-pagination"},[e("Page",{attrs:{total:t.table.total,current:t.table.page,"show-elevator":"",pageSize:t.table.pagesize},on:{"on-change":t.changePage}})],1),t._v(" "),e("Modal",{attrs:{"mask-closable":!1,width:"535","class-name":"ma-upload-modal"},model:{value:t.editPicModal,callback:function(a){t.editPicModal=a},expression:"editPicModal"}},[e("div",{staticClass:"edit-modal-body"},[e("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":80}},[e("FormItem",{attrs:{label:"上传图片",prop:"uploadimg"}},[t.isShow?e("div",{staticClass:"h5ImgBox"},[e("img",{staticStyle:{width:"98px",height:"98px"},attrs:{src:t.h5Img}})]):t._e(),t._v(" "),e("div",[e("label",{staticClass:"button",attrs:{for:"inputFile"}},[e("span",{staticClass:"upload__select"},[t._v("点击上传图片")]),t._v(" "),e("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"inputFile",accept:"image/gif, image/jpeg, image/png, image/jpg"},on:{change:t.onUpload}})])])])],1)],1),t._v(" "),e("div",{staticClass:"zhijian-btn-box"},[e("div",{staticClass:"zhijian-btn-confirm",on:{click:function(a){t.submitForm("formValidate")}}},[t._v("确定")])])]),t._v(" "),e("Modal",{attrs:{"mask-closable":!1,width:"535","class-name":"ma-upload-modal"},model:{value:t.uploadModal,callback:function(a){t.uploadModal=a},expression:"uploadModal"}},[e("div",{staticClass:"edit-modal-body"},[e("div",{staticClass:"title"},[t._v("请选择需要上线的类型")]),t._v(" "),t._l(t.groups,function(a){return e("Checkbox-group",{key:a.groups,on:{"on-change":t.checkMoreGroupChange},model:{value:t.checkedGroup,callback:function(a){t.checkedGroup=a},expression:"checkedGroup"}},[e("Checkbox",{attrs:{label:a.group_id}},[t._v(t._s(a.group_name))])],1)})],2),t._v(" "),e("div",{staticClass:"zhijian-btn-box"},[e("div",{staticClass:"zhijian-btn-confirm",on:{click:t.editcategory}},[t._v("确定")])])]),t._v(" "),e("Modal",{attrs:{"mask-closable":!1,width:"535","class-name":"ma-edit-modal"},model:{value:t.addLinkModal,callback:function(a){t.addLinkModal=a},expression:"addLinkModal"}},[e("div",{staticClass:"edit-modal-body hint"},[e("Icon",{attrs:{type:"android-close"},on:{click:function(a){t.editModal=!1}}}),t._v(" "),e("Form",{ref:"formValidate1",attrs:{model:t.formValidate1,rules:t.ruleValidate1,"label-width":100}},[e("FormItem",{attrs:{label:"文章链接",prop:"link"}},[e("Input",{attrs:{type:"text",placeholder:"请输入文章链接"},model:{value:t.formValidate1.link,callback:function(a){t.$set(t.formValidate1,"link",a)},expression:"formValidate1.link"}})],1),t._v(" "),e("FormItem",{attrs:{label:""}},[e("p",{staticStyle:{color:"#ccc"}},[t._v("*请使用移动端进入公众号文章复制链接")])])],1)],1),t._v(" "),e("div",{staticClass:"zhijian-btn-box"},[t.isHide?e("Button",{staticClass:"newbtn zhijian-new-btn",attrs:{type:"primary"},on:{click:function(a){t.submitLinkForm("formValidate1")}}},[t._v("确定")]):t._e(),t._v(" "),e("Col",{directives:[{name:"show",rawName:"v-show",value:t.isLoding,expression:"isLoding"}],staticClass:"demo-spin-col",attrs:{span:"8"}},[e("Spin",{attrs:{fix:""}},[t._v("加载中...")])],1)],1)]),t._v(" "),e("Modal",{attrs:{title:"Common Modal dialog box title",width:"735"},model:{value:t.detailModal,callback:function(a){t.detailModal=a},expression:"detailModal"}},[e("div",{staticClass:"detail"},[e("h1",[t._v(t._s(t.art_detail.title))]),t._v(" "),e("div",{staticClass:"come-from"},[e("span",[t._v("转载："+t._s(t.art_detail.author))]),t._v(" "),e("span",[t._v(t._s(t.art_detail.wechat_art_date))])]),t._v(" "),t._l(t.art_detail.content,function(a,i){return e("div",{key:i},[a.text?e("p",{staticClass:"cont-text"},[t._v(t._s(a.text))]):e("img",{staticClass:"cont-img",attrs:{mode:"aspectFit",src:a.img,alt:""}})])})],2)])],1)},staticRenderFns:[]};var s=e("VU/8")(n,r,!1,function(t){e("VnUV")},null,null);a.default=s.exports}});